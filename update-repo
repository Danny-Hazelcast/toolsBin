
#!/bin/sh

set -e

repo=$1
target=${2:-master}
build=${3:lazeyBuild}

git -C "${repo}" fetch --tags
git -C "${repo}" remote update
git -C "${repo}" checkout "${target}"


res=$(git -C "${repo}" pull || true)
echo "$repo $res"

if [ "$res" == "Already up-to-date." ] && [ "$build" != "build" ] ; then
  exit 0
fi


if ! mvn -f "${repo}/pom.xml" clean install -DskipTests ; then
  exit 1
fi

